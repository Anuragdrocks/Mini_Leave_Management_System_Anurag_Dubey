-- Employees table
CREATE TABLE IF NOT EXISTS employees (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    department TEXT NOT NULL,
    joining_date TEXT NOT NULL
);

-- Leaves table
CREATE TABLE IF NOT EXISTS leaves (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    employee_id INTEGER NOT NULL,
    start_date TEXT NOT NULL,
    end_date TEXT NOT NULL,
    reason TEXT NOT NULL,
    days INTEGER NOT NULL,
    status TEXT NOT NULL DEFAULT 'PENDING',
    approved_by INTEGER,
    approved_at TEXT,
    approval_comment TEXT,
    FOREIGN KEY (employee_id) REFERENCES employees(id)
);

-- Leave balances table
CREATE TABLE IF NOT EXISTS leave_balances (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    employee_id INTEGER NOT NULL,
    year INTEGER NOT NULL,
    entitlement INTEGER NOT NULL DEFAULT 30, -- total leaves allowed per year
    used INTEGER NOT NULL DEFAULT 0, -- leaves already taken
    FOREIGN KEY (employee_id) REFERENCES employees(id)
);
